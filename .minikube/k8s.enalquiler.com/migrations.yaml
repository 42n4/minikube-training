---
apiVersion: v1
kind: Pod
metadata:
  name: symfony-demo-migrations
  namespace: symfony-demo
  labels:
    app: symfony-demo
    env: prod
spec:
  containers:
  - name: cli-migrations
    image: enalquilertrainings/minikube-training-php:cli
    imagePullPolicy: Always
    command: ["php", "bin/console", "doc:mig:m", "--no-interaction"]
    env:
      - name: APP_ENV
        valueFrom:
          secretKeyRef:
            name: symfony-demo-cli-params
            key: app_env
      - name: APP_DEBUG
        valueFrom:
          secretKeyRef:
            name: symfony-demo-cli-params
            key: app_debug
      - name: APP_SECRET
        valueFrom:
          secretKeyRef:
            name: symfony-demo-cli-params
            key: app_secret
      - name: DATABASE_URL
        valueFrom:
          secretKeyRef:
            name: symfony-demo-cli-params
            key: database_url
      - name: MAILER_URL
        valueFrom:
          secretKeyRef:
            name: symfony-demo-cli-params
            key: mailer_url
  restartPolicy: Never
  imagePullSecrets:
  - name: enalquiler-registry